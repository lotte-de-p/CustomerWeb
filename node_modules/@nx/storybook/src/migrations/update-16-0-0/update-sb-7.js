"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const output_1 = require("nx/src/utils/output");
const migrate_7_1 = require("../../generators/migrate-7/migrate-7");
const utilities_1 = require("../../utils/utilities");
async function changeStorybookTargets(tree) {
    const storybookVersion = (0, utilities_1.storybookMajorVersion)();
    if (!storybookVersion) {
        /**
         * This just checks if Storybook is installed in the workspace.
         * The thing here is that during the previous step of the migration,
         * during packageJsonUpdates, Nx has already set Storybook
         * to version 7, if Storybook exists in the workspace.
         * So, it makes no sense here to check if the version is
         * 7, because it will always be.
         */
        return;
    }
    output_1.output.log({
        title: 'Migrating Storybook to v7',
        bodyLines: [
            `ðŸš€ This migration will update your Storybook configuration to v7.`,
            `It will call the @nx/storybook:migrate-7 generator for you.`,
            `You can read more about the migration and how this generator works here:`,
            `https://nx.dev/packages/storybook/generators/migrate-7`,
        ],
    });
    return (0, migrate_7_1.default)(tree, { autoAcceptAllPrompts: true });
}
exports.default = changeStorybookTargets;
