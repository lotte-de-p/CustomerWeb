{"version":3,"file":"dropdown-menu.js","sourceRoot":"","sources":["../../../../../../../../src/components/dropdown-menu/dropdown-menu.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Element, h, Host, Listen, Prop, State } from '@stencil/core';\nimport { DROPDOWN_ALIGN, DropdownAlign } from './models/dropdown-menu.types';\nimport { ICON_SIZES } from '../icon/models/icon.types';\n\n@Component({\n  tag: 'wink-dropdown-menu',\n  styleUrls: {\n    telenet: 'styles/brands/dropdown-menu.telenet.scss',\n    base: 'styles/brands/dropdown-menu.base.scss',\n  },\n  shadow: true,\n})\nexport class DropdownMenu {\n  @Element() host!: HTMLWinkDropdownMenuElement;\n\n  @Prop() heading?: string = 'default-1';\n  @Prop({ mutable: true }) isExpanded?: boolean = false;\n  @Prop() dropdownTabIndex?: number = 1;\n  @Prop() itemSelected?: string;\n\n  @State() listPosition: DropdownAlign = DROPDOWN_ALIGN.topLeft;\n  @State() focusableItem = NaN;\n\n  componentDidLoad(): void {\n    this.setPosition();\n    for (let i = 0; i < this.getDropdownItems().length; i++) {\n      if (this.getDropdownItems()[i].innerText === this.itemSelected) {\n        this.getDropdownItems()[i].classList.add('active');\n      }\n    }\n  }\n\n  @Listen('keydown', {\n    passive: true,\n  })\n  handleKeyDown(ev: KeyboardEvent) {\n    switch (ev.key) {\n      case ' ':\n      case 'Enter': {\n        const element = ev?.target as HTMLElement;\n        if (element.tagName.toUpperCase() === 'WINK-LINK') {\n          element?.shadowRoot?.querySelector('a')?.click();\n        } else {\n          this.toggleDropdown(ev);\n        }\n        break;\n      }\n      case 'Tab': {\n        if (ev.target === this.getDropdownItems()[this.getDropdownItems().length - 1]) {\n          this.toggleDropdown(ev);\n        }\n        break;\n      }\n      case 'ArrowDown': {\n        if (Number.isNaN(this.focusableItem) || this.focusableItem === this.getDropdownItems().length - 1) {\n          this.focusableItem = 0;\n        } else {\n          this.focusableItem++;\n        }\n        this.focusOnItem(this.focusableItem);\n        break;\n      }\n      case 'ArrowUp': {\n        if (!this.focusableItem || this.focusableItem === -1) {\n          this.focusableItem = this.getDropdownItems().length - 1;\n        } else {\n          this.focusableItem--;\n        }\n        this.focusOnItem(this.focusableItem);\n        break;\n      }\n      case 'Escape': {\n        this.isExpanded = false;\n        this.host.shadowRoot?.querySelector('button')?.focus();\n        break;\n      }\n      case 'Home': {\n        this.focusableItem = 0;\n        this.focusOnItem(this.focusableItem);\n        break;\n      }\n      case 'End': {\n        this.focusableItem = this.getDropdownItems().length - 1;\n        this.focusOnItem(this.focusableItem);\n        break;\n      }\n    }\n  }\n\n  private focusOnItem(focusItem: number) {\n    const itemToFocus = this.getDropdownItems()[focusItem];\n    if (itemToFocus instanceof HTMLElement) {\n      return itemToFocus?.shadowRoot?.querySelector('a')?.focus();\n    }\n  }\n\n  private getDropdownItems() {\n    return this.host.querySelectorAll('wink-link');\n  }\n\n  private readonly toggleDropdown = (_e: Event) => {\n    this.setPosition();\n    this.isExpanded = !this.isExpanded;\n  };\n\n  private readonly setPosition = () => {\n    const dropdownRect = this.host.getBoundingClientRect();\n    const viewportWidth = window.innerWidth;\n    const viewportHeight = window.innerHeight;\n\n    const spaceOnLeft = dropdownRect.left;\n    const spaceOnRight = viewportWidth - dropdownRect.right;\n    const spaceOnTop = dropdownRect.top;\n    const spaceOnBottom = viewportHeight - dropdownRect.bottom;\n\n    const positionX = Math.max(spaceOnLeft, spaceOnRight) === spaceOnRight ? 'left' : 'right';\n    const positionY = Math.max(spaceOnTop, spaceOnBottom) === spaceOnBottom ? 'top' : 'bottom';\n\n    this.listPosition = `${positionY}-${positionX}`;\n  };\n\n  render() {\n    return (\n      <Host\n        class={`dropdown-menu--align-list--${this.listPosition}`}\n        is-expanded={this.isExpanded}\n        onMouseDown={this.toggleDropdown}\n        exportparts=\"icon, icon-chevron-down-small\">\n        <button class=\"dropdown-menu--heading\" tabindex={this.dropdownTabIndex}>\n          <slot name=\"dropdown-menu--avatar\" />\n          {this.heading}\n          <div class=\"dropdown-menu--chevron\">\n            <wink-icon size={ICON_SIZES.sm} icon=\"chevron-down-small\"></wink-icon>\n          </div>\n        </button>\n        <ul class=\"dropdown-menu--list\">\n          <slot></slot>\n        </ul>\n      </Host>\n    );\n  }\n}\n"]}