import { includes, some, isEmpty, merge } from 'lodash-es';
import { LoginDetailsConstants } from '../constants';
export class LoginDetails {
    state;
    nonce;
    status;
    narrowed = false;
    httpStatus;
    scopes;
    bssSystem;
    customerNumber;
    identityId;
    username;
    firstName;
    lastName;
    narrowedScope;
    authAge;
    isPid;
    bssSytem;
    isImpersonated;
    role;
    isExplicitLogin;
    isTelenetLogin;
    isSubLogin;
    loginAlias;
    identityRequestId;
    pegaServiceCaseId;
    contactNumber;
    advisorId;
    msisdn;
    constructor(httpStatus) {
        this.httpStatus = httpStatus;
    }
    isLoggedIn() {
        return this.httpStatus === 200;
    }
    isNarrowed() {
        return this.isLoggedIn() && this.narrowedScope;
    }
    invalidResponse() {
        return this.httpStatus === 0;
    }
    isAuthenticated() {
        return this.isLoggedIn() && !this.isNarrowed() && !this.invalidResponse();
    }
    isMaster() {
        return !isEmpty(this.role) && includes(LoginDetailsConstants.MASTER_ROLES, this.role);
    }
    isChild() {
        return !isEmpty(this.role) && includes(LoginDetailsConstants.CHILD_ROLES, this.role);
    }
    isMember() {
        return !isEmpty(this.role) && this.role.toUpperCase().includes(LoginDetailsConstants.MEMBER_ROLE);
    }
    isContractHolder() {
        return !isEmpty(this.role) && this.role.toUpperCase().includes(LoginDetailsConstants.CONTRACT_HOLDER_ROLE);
    }
    isOrphan() {
        return !isEmpty(this.role) && this.role.toUpperCase().includes(LoginDetailsConstants.ORPHAN_ROLE);
    }
    isNewlyRegisteredUser() {
        return !!isEmpty(this.role) && !isEmpty(this.firstName);
    }
    getName() {
        return this.firstName.concat(LoginDetailsConstants.EMPTY).concat(this.lastName);
    }
    getShortenedName() {
        return this.getName().length <= LoginDetailsConstants.CHARACTER_LIMIT
            ? this.getName()
            : this.getName()
                .substring(0, LoginDetailsConstants.CHARACTER_LIMIT - LoginDetailsConstants.SUFFIX.length)
                .concat(LoginDetailsConstants.SUFFIX);
    }
    isCafeUser() {
        return this.bssSystem === LoginDetailsConstants.BSS_SYSTEM_TELENET_LEGACY;
    }
    isBaseLegacyCustomer() {
        return this.bssSystem === LoginDetailsConstants.BSS_SYSTEM_BASE_LEGACY;
    }
    isBssSystemNetcracker() {
        return this.bssSystem === LoginDetailsConstants.BSS_SYSTEM_NETCRACKER;
    }
    hasScope(scopeName) {
        return some(this.scopes, function (scope) {
            return scope.toUpperCase() === scopeName.toUpperCase();
        });
    }
    isFleetManager() {
        return !isEmpty(this.role) && this.role === LoginDetailsConstants.FLEET_MANAGER_ROLE;
    }
    isFleetUser() {
        return !isEmpty(this.role) && this.role === LoginDetailsConstants.FLEET_USER_ROLE;
    }
    isManager() {
        return !isEmpty(this.role) && this.role === LoginDetailsConstants.MANAGER_ROLE;
    }
    hasManagerRole() {
        return !isEmpty(this.role) && LoginDetailsConstants.MANAGER_ROLES.includes(this.role);
    }
    enrich(loginDetailsJSON) {
        let enrichedLoginDetails = new LoginDetails(401);
        if (!isEmpty(loginDetailsJSON)) {
            enrichedLoginDetails = merge(enrichedLoginDetails, loginDetailsJSON);
        }
        return enrichedLoginDetails;
    }
    isNotLoggedInOrDoesNotHaveScope(scope) {
        return !this.isLoggedIn() || !this.hasScope(scope);
    }
    get isSuccess() {
        return this.httpStatus === 200;
    }
    // useless setter but needed to avoid 'cannot set property on [object Object] which only has getter
    set isSuccess(success) {
        if (success) {
            this.httpStatus = 200;
        }
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9naW4tZGV0YWlscy5tb2RlbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9saWIvbW9kZWxzL2xvZ2luLWRldGFpbHMubW9kZWwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsT0FBTyxFQUFFLFFBQVEsRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLEtBQUssRUFBRSxNQUFNLFdBQVcsQ0FBQztBQUMzRCxPQUFPLEVBQUUscUJBQXFCLEVBQUUsTUFBTSxjQUFjLENBQUM7QUFFckQsTUFBTSxPQUFPLFlBQVk7SUFDdkIsS0FBSyxDQUFTO0lBQ2QsS0FBSyxDQUFTO0lBQ2QsTUFBTSxDQUFTO0lBQ2YsUUFBUSxHQUFHLEtBQUssQ0FBQztJQUNqQixVQUFVLENBQVM7SUFDbkIsTUFBTSxDQUFXO0lBQ2pCLFNBQVMsQ0FBUztJQUNsQixjQUFjLENBQVM7SUFDdkIsVUFBVSxDQUFTO0lBQ25CLFFBQVEsQ0FBUztJQUNqQixTQUFTLENBQVM7SUFDbEIsUUFBUSxDQUFTO0lBQ2pCLGFBQWEsQ0FBVTtJQUN2QixPQUFPLENBQVM7SUFDaEIsS0FBSyxDQUFVO0lBQ2YsUUFBUSxDQUFTO0lBQ2pCLGNBQWMsQ0FBVTtJQUN4QixJQUFJLENBQVM7SUFDYixlQUFlLENBQVU7SUFDekIsY0FBYyxDQUFVO0lBQ3hCLFVBQVUsQ0FBVTtJQUNwQixVQUFVLENBQVM7SUFDbkIsaUJBQWlCLENBQVU7SUFDM0IsaUJBQWlCLENBQVU7SUFDM0IsYUFBYSxDQUFVO0lBQ3ZCLFNBQVMsQ0FBVTtJQUVuQixNQUFNLENBQVU7SUFFaEIsWUFBWSxVQUFrQjtRQUM1QixJQUFJLENBQUMsVUFBVSxHQUFHLFVBQVUsQ0FBQztJQUMvQixDQUFDO0lBRUQsVUFBVTtRQUNSLE9BQU8sSUFBSSxDQUFDLFVBQVUsS0FBSyxHQUFHLENBQUM7SUFDakMsQ0FBQztJQUVELFVBQVU7UUFDUixPQUFPLElBQUksQ0FBQyxVQUFVLEVBQUUsSUFBSSxJQUFJLENB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QUFJLFNBQVMsQ0FBQyxPQUFnQjtRQUM1QixJQUFJLE9BQU8sRUFBRSxDQUFDO1lBQ1osSUFBSSxDQUFDLFVBQVUsR0FBRyxHQUFHLENBQUM7UUFDeEIsQ0FBQztJQUNILENBQUM7Q0FDRiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbnRleHRIdWJNb2RlbEludGVyZmFjZSB9IGZyb20gJ0B0ZWxlbmV0L25nLWxpYi1wYWdlJztcbmltcG9ydCB7IGluY2x1ZGVzLCBzb21lLCBpc0VtcHR5LCBtZXJnZSB9IGZyb20gJ2xvZGFzaC1lcyc7XG5pbXBvcnQgeyBMb2dpbkRldGFpbHNDb25zdGFudHMgfSBmcm9tICcuLi9jb25zdGFudHMnO1xuXG5leHBvcnQgY2xhc3MgTG9naW5EZXRhaWxzIGltcGxlbWVudHMgQ29udGV4dEh1Yk1vZGVsSW50ZXJmYWNlPExvZ2luRGV0YWlscz4ge1xuICBzdGF0ZTogc3RyaW5nO1xuICBub25jZTogc3RyaW5nO1xuICBzdGF0dXM6IHN0cmluZztcbiAgbmFycm93ZWQgPSBmYWxzZTtcbiAgaHR0cFN0YXR1czogbnVtYmVyO1xuICBzY29wZXM6IHN0cmluZ1tdO1xuICBic3NTeXN0ZW06IHN0cmluZztcbiAgY3VzdG9tZXJOdW1iZXI6IHN0cmluZztcbiAgaWRlbnRpdHlJZDogc3RyaW5nO1xuICB1c2VybmFtZTogc3RyaW5nO1xuICBmaXJzdE5hbWU6IHN0cmluZztcbiAgbGFzdE5hbWU6IHN0cmluZztcbiAgbmFycm93ZWRTY29wZTogYm9vbGVhbjtcbiAgYXV0aEFnZTogbnVtYmVyO1xuICBpc1BpZDogYm9vbGVhbjtcbiAgYnNzU3l0ZW06IHN0cmluZztcbiAgaXNJbXBlcnNvbmF0ZWQ6IGJvb2xlYW47XG4gIHJvbGU6IHN0cmluZztcbiAgaXNFeHBsaWNpdExvZ2luOiBib29sZWFuO1xuICBpc1RlbGVuZXRMb2dpbjogYm9vbGVhbjtcbiAgaXNTdWJMb2dpbjogYm9vbGVhbjtcbiAgbG9naW5BbGlhczogc3RyaW5nO1xuICBpZGVudGl0eVJlcXVlc3RJZD86IHN0cmluZztcbiAgcGVnYVNlcnZpY2VDYXNlSWQ/OiBzdHJpbmc7XG4gIGNvbnRhY3ROdW1iZXI/OiBzdHJpbmc7XG4gIGFkdmlzb3JJZD86IHN0cmluZztcblxuICBtc2lzZG4/OiBzdHJpbmc7XG5cbiAgY29uc3RydWN0b3IoaHR0cFN0YXR1czogbnVtYmVyKSB7XG4gICAgdGhpcy5odHRwU3RhdHVzID0gaHR0cFN0YXR1cztcbiAgfVxuXG4gIGlzTG9nZ2VkSW4oKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuaHR0cFN0YXR1cyA9PT0gMjAwO1xuICB9XG5cbiAgaXNOYXJyb3dlZCgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5pc0xvZ2dlZEluKCkgJiYgdGhpcy5uYXJyb3dlZFNjb3BlO1xuICB9XG5cbiAgaW52YWxpZFJlc3BvbnNlKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmh0dHBTdGF0dXMgPT09IDA7XG4gIH1cblxuICBpc0F1dGhlbnRpY2F0ZWQoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuaXNMb2dnZWRJbigpICYmICF0aGlzLmlzTmFycm93ZWQoKSAmJiAhdGhpcy5pbnZhbGlkUmVzcG9uc2UoKTtcbiAgfVxuXG4gIGlzTWFzdGVyKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiAhaXNFbXB0eSh0aGlzLnJvbGUpICYmIGluY2x1ZGVzKExvZ2luRGV0YWlsc0NvbnN0YW50cy5NQVNURVJfUk9MRVMsIHRoaXMucm9sZSk7XG4gIH1cblxuICBpc0NoaWxkKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiAhaXNFbXB0eSh0aGlzLnJvbGUpICYmIGluY2x1ZGVzKExvZ2luRGV0YWlsc0NvbnN0YW50cy5DSElMRF9ST0xFUywgdGhpcy5yb2xlKTtcbiAgfVxuXG4gIGlzTWVtYmVyKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiAhaXNFbXB0eSh0aGlzLnJvbGUpICYmIHRoaXMucm9sZS50b1VwcGVyQ2FzZSgpLmluY2x1ZGVzKExvZ2luRGV0YWlsc0NvbnN0YW50cy5NRU1CRVJfUk9MRSk7XG4gIH1cblxuICBpc0NvbnRyYWN0SG9sZGVyKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiAhaXNFbXB0eSh0aGlzLnJvbGUpICYmIHRoaXMucm9sZS50b1VwcGVyQ2FzZSgpLmluY2x1ZGVzKExvZ2luRGV0YWlsc0NvbnN0YW50cy5DT05UUkFDVF9IT0xERVJfUk9MRSk7XG4gIH1cblxuICBpc09ycGhhbigpOiBib29sZWFuIHtcbiAgICByZXR1cm4gIWlzRW1wdHkodGhpcy5yb2xlKSAmJiB0aGlzLnJvbGUudG9VcHBlckNhc2UoKS5pbmNsdWRlcyhMb2dpbkRldGFpbHNDb25zdGFudHMuT1JQSEFOX1JPTEUpO1xuICB9XG5cbiAgaXNOZXdseVJlZ2lzdGVyZWRVc2VyKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiAhIWlzRW1wdHkodGhpcy5yb2xlKSAmJiAhaXNFbXB0eSh0aGlzLmZpcnN0TmFtZSk7XG4gIH1cblxuICBnZXROYW1lKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuZmlyc3ROYW1lLmNvbmNhdChMb2dpbkRldGFpbHNDb25zdGFudHMuRU1QVFkpLmNvbmNhdCh0aGlzLmxhc3ROYW1lKTtcbiAgfVxuXG4gIGdldFNob3J0ZW5lZE5hbWUoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5nZXROYW1lKCkubGVuZ3RoIDw9IExvZ2luRGV0YWlsc0NvbnN0YW50cy5DSEFSQUNURVJfTElNSVRcbiAgICAgID8gdGhpcy5nZXROYW1lKClcbiAgICAgIDogdGhpcy5nZXROYW1lKClcbiAgICAgICAgICAuc3Vic3RyaW5nKDAsIExvZ2luRGV0YWlsc0NvbnN0YW50cy5DSEFSQUNURVJfTElNSVQgLSBMb2dpbkRldGFpbHNDb25zdGFudHMuU1VGRklYLmxlbmd0aClcbiAgICAgICAgICAuY29uY2F0KExvZ2luRGV0YWlsc0NvbnN0YW50cy5TVUZGSVgpO1xuICB9XG5cbiAgaXNDYWZlVXNlcigpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5ic3NTeXN0ZW0gPT09IExvZ2luRGV0YWlsc0NvbnN0YW50cy5CU1NfU1lTVEVNX1RFTEVORVRfTEVHQUNZO1xuICB9XG5cbiAgaXNCYXNlTGVnYWN5Q3VzdG9tZXIoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuYnNzU3lzdGVtID09PSBMb2dpbkRldGFpbHNDb25zdGFudHMuQlNTX1NZU1RFTV9CQVNFX0xFR0FDWTtcbiAgfVxuXG4gIGlzQnNzU3lzdGVtTmV0Y3JhY2tlcigpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5ic3NTeXN0ZW0gPT09IExvZ2luRGV0YWlsc0NvbnN0YW50cy5CU1NfU1lTVEVNX05FVENSQUNLRVI7XG4gIH1cblxuICBoYXNTY29wZShzY29wZU5hbWU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBzb21lKHRoaXMuc2NvcGVzLCBmdW5jdGlvbiAoc2NvcGUpIHtcbiAgICAgIHJldHVybiBzY29wZS50b1VwcGVyQ2FzZSgpID09PSBzY29wZU5hbWUudG9VcHBlckNhc2UoKTtcbiAgICB9KTtcbiAgfVxuXG4gIGlzRmxlZXRNYW5hZ2VyKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiAhaXNFbXB0eSh0aGlzLnJvbGUpICYmIHRoaXMucm9sZSA9PT0gTG9naW5EZXRhaWxzQ29uc3RhbnRzLkZMRUVUX01BTkFHRVJfUk9MRTtcbiAgfVxuXG4gIGlzRmxlZXRVc2VyKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiAhaXNFbXB0eSh0aGlzLnJvbGUpICYmIHRoaXMucm9sZSA9PT0gTG9naW5EZXRhaWxzQ29uc3RhbnRzLkZMRUVUX1VTRVJfUk9MRTtcbiAgfVxuXG4gIGlzTWFuYWdlcigpOiBib29sZWFuIHtcbiAgICByZXR1cm4gIWlzRW1wdHkodGhpcy5yb2xlKSAmJiB0aGlzLnJvbGUgPT09IExvZ2luRGV0YWlsc0NvbnN0YW50cy5NQU5BR0VSX1JPTEU7XG4gIH1cblxuICBoYXNNYW5hZ2VyUm9sZSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gIWlzRW1wdHkodGhpcy5yb2xlKSAmJiBMb2dpbkRldGFpbHNDb25zdGFudHMuTUFOQUdFUl9ST0xFUy5pbmNsdWRlcyh0aGlzLnJvbGUpO1xuICB9XG5cbiAgZW5yaWNoKGxvZ2luRGV0YWlsc0pTT046IHVua25vd24pOiBMb2dpbkRldGFpbHMge1xuICAgIGxldCBlbnJpY2hlZExvZ2luRGV0YWlscyA9IG5ldyBMb2dpbkRldGFpbHMoNDAxKTtcbiAgICBpZiAoIWlzRW1wdHkobG9naW5EZXRhaWxzSlNPTikpIHtcbiAgICAgIGVucmljaGVkTG9naW5EZXRhaWxzID0gbWVyZ2UoZW5yaWNoZWRMb2dpbkRldGFpbHMsIGxvZ2luRGV0YWlsc0pTT04pO1xuICAgIH1cbiAgICByZXR1cm4gZW5yaWNoZWRMb2dpbkRldGFpbHM7XG4gIH1cblxuICBpc05vdExvZ2dlZEluT3JEb2VzTm90SGF2ZVNjb3BlKHNjb3BlOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gIXRoaXMuaXNMb2dnZWRJbigpIHx8ICF0aGlzLmhhc1Njb3BlKHNjb3BlKTtcbiAgfVxuXG4gIGdldCBpc1N1Y2Nlc3MoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuaHR0cFN0YXR1cyA9PT0gMjAwO1xuICB9XG5cbiAgLy8gdXNlbGVzcyBzZXR0ZXIgYnV0IG5lZWRlZCB0byBhdm9pZCAnY2Fubm90IHNldCBwcm9wZXJ0eSBvbiBbb2JqZWN0IE9iamVjdF0gd2hpY2ggb25seSBoYXMgZ2V0dGVyXG4gIHNldCBpc1N1Y2Nlc3Moc3VjY2VzczogYm9vbGVhbikge1xuICAgIGlmIChzdWNjZXNzKSB7XG4gICAgICB0aGlzLmh0dHBTdGF0dXMgPSAyMDA7XG4gICAgfVxuICB9XG59XG4iXX0=